<div class="container">
    <div class="col-lg-12", style="margin-top: 65px;" >
      <div class="row">
          <% @books.each do |book| %>
            <div class="col-lg-3">
              <div class="card mb-5" style="width: 18rem; margin-left: 20px; margin-top: 30px">
                <%= link_to book_path(book) do %>
                <img class="card-img-top" src="https://img.freepik.com/premium-photo/opened-book-with-flying-pages-butterflies-dark-backgroundgenerative-ai_391052-12859.jpg" alt="Card image cap">
                <% end %>
                  <div class="card-body">
                    <h5 class="card-title"><strong>Status: </strong><%= book.status%></h5>
                    <h5 class="card-title"><strong>Type: </strong><%= book.type%></h5>
                    <!-- <%# link_to "Details", book_path(book), class: "btn btn-info"%>
                    <# form_with(url: "/bookings/", method: :post) do |form| %>
                      <%# form.hidden_field :id , value: book.id %>
                      <button type="submit" class="btn btn-warning">Book Now</button>
                    <%# end %> -->





                    
















<%= link_to "Details", book_path(book), class: "btn btn-info" %>
<%= form_with(url: "/bookings/", method: :post, id: "booking-form") do |form| %>
<%= form.hidden_field :id, value: book.id %>
<button type="submit" class="btn btn-warning" id="book-now-button">Book Now</button>
<% end %>

<script>
  document.addEventListener("DOMContentLoaded", function () {
    const bookingForm = document.getElementById("booking-form");
    const bookNowButton = document.getElementById("book-now-button");

    bookNowButton.addEventListener("click", function (event) {
      event.preventDefault();
      const borrowed_books = Book.status("Borrowed");
      // Check the book status here (you need to replace this with your actual logic)
      //const isBookBorrowed = true; // Replace with your logic to check if the book is already borrowed

      if (borrowed_books) {
        alert("This book is already borrowed.");
      } else {
        // If the book is not already borrowed, submit the form
        bookingForm.submit();
      }
    });
  });
</script>

                    <!-- <% if current_user %>
                    <% if user_signed_in? %>
                      <% if current_user.has_role?('librarian') %>
                      <td><%= link_to 'Delete', book_path(book), data: {turbo_method: :delete, turbo_confirm: 'Are you sure?'},  class: "btn btn-outline-success btn-md", role: "button" %>
                      <% end %>
                      <% end %>
                    <% end %> -->
                      <!-- <button type="submit" class="btn btn-warning",>Book Now</button> -->
                  </div>
                </div>
              </div>
          <% end %>
      </div>
    </div>
</div>